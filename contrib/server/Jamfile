#If you get compilation errors here, make sure you have xmlrpc-c installed properly. . . 

import option ;

if [ option.get "with-xmlrpc-c" ]
{
  with-xmlrpc-c = [ option.get "with-xmlrpc-c" ] ;
  xmlrpc-lib = <search>$(with-xmlrpc-c)/lib ;
  xmlrpc-include = <include>$(with-xmlrpc-c)/include ;
  build-moses-server = "yes" ;
} else {
  if [ SHELL $(TOP)"/jam-files/test.sh -include xmlrpc-c/base.hpp -E" ] = 0 {
    build-moses-server = "yes" ;
  }
}

if $(build-moses-server) = "yes"
{
  xmlrpc-deps = ;
  #This is the libraries in reverse order
  for xmllib in xmlrpc_xmltok xmlrpc_xmlparse xmlrpc_util xmlrpc xmlrpc_abyss xmlrpc_server xmlrpc_server_abyss xmlrpc++ xmlrpc_server++ xmlrpc_server_abyss++ {
    lib $(xmllib) : : <use>$(xmlrpc-deps) $(xmlrpc-lib) : : $(xmlrpc-include) ;
    xmlrpc-deps = $(xmlrpc-deps) $(xmllib) ;
  }

  exe mosesserver : mosesserver.cpp ../../moses/src//moses ../../OnDiskPt/src//OnDiskPt $(xmlrpc-deps) ;
} else {
  alias mosesserver ;
}
