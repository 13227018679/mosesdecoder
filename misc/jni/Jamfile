path-constant CWD : . ;

local includes = <include>. ;
local with-java = [ option.get "with-java" ] ;
if $(with-java) {
    includes += <include>$(with-java)/include ;
    includes += <include>$(with-java)/include/linux ;
}

lib JniQueryPt : QueryPt.cpp QueryPt_wrap.cpp ../../moses/src//moses : <link>shared $(includes) ;

make JniQueryPt.jar : JniQueryPt : @ant ;

actions ant
{
    ant -f $(CWD)/build.xml
    mv $(CWD)/JniQueryPt.jar $(1)
    cp $(1) $(TOP)/bin/.
}

make $(TOP)/bin/JniQueryPt.jar : JniQueryPt.jar : @common.copy ;
make $(TOP)/bin/JniQueryPt_example.sh : example.sh : @common.copy ;

alias jni : $(TOP)/bin/JniQueryPt.jar $(TOP)/bin/JniQueryPt_example.sh ;
