#!/usr/bin/env bash

# NAME
#     vw_test_dlm -- run testing of Vowpal Wabbit-learned discriminative 
#     lexicon model
# 
# SYNOPSIS
#     vw_test_dlm MODEL SAMPLE RAW_PREDICTIONS_OUT
# 
# DESCRIPTION
#     Runs VW evaluation of DLM task.
#
#     Sample file can be generated e.g. by extract_features_dlm_baseline.py, 
#     and model file can be generated by vw_train_dlm script.
#
#     MODEL
#         model file generated by vw_train_dlm script
#  
#     SAMPLE
#         sample file with extracted features (generated e.g. by 
#         extract_features_dlm_baseline.py), should be gzipped
#
#     RAW_PREDICTIONS_OUT
#         path to file, where unnormalized VW predictions will be written

MODEL=$1
SAMPLE=$2
RAW_PREDICTIONS_OUT=$3

vw --quadratic st \
   --hash all \
   --noconstant \
   --bit_precision 26 \
   --csoaa_ldf mc \
   --testonly \
   --initial_regressor $MODEL \
   --raw_predictions $RAW_PREDICTIONS_OUT
